<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Juan Carlos Villaseñor-Derbez (JC)">

<title>Data Tidying and Merging</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="07_live_files/libs/clipboard/clipboard.min.js"></script>
<script src="07_live_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="07_live_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="07_live_files/libs/quarto-html/popper.min.js"></script>
<script src="07_live_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="07_live_files/libs/quarto-html/anchor.min.js"></script>
<link href="07_live_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="07_live_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="07_live_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="07_live_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="07_live_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="07_live_files/libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="07_live_files/libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="07_live_files/libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#exercise-1-tidying-price-data" id="toc-exercise-1-tidying-price-data" class="nav-link active" data-scroll-target="#exercise-1-tidying-price-data">Exercise 1: Tidying price data</a>
  <ul class="collapse">
  <li><a href="#part-a-downloading-the-data" id="toc-part-a-downloading-the-data" class="nav-link" data-scroll-target="#part-a-downloading-the-data">Part A: Downloading the data</a></li>
  <li><a href="#part-b-reading-excel-data" id="toc-part-b-reading-excel-data" class="nav-link" data-scroll-target="#part-b-reading-excel-data">Part B: Reading excel data</a></li>
  <li><a href="#part-c-inspecting-price-data" id="toc-part-c-inspecting-price-data" class="nav-link" data-scroll-target="#part-c-inspecting-price-data">Part C: Inspecting price data</a></li>
  <li><a href="#part-d-tidy-your-price-data" id="toc-part-d-tidy-your-price-data" class="nav-link" data-scroll-target="#part-d-tidy-your-price-data">Part D: Tidy your price data</a></li>
  <li><a href="#part-e-calculate-mean-annual-price" id="toc-part-e-calculate-mean-annual-price" class="nav-link" data-scroll-target="#part-e-calculate-mean-annual-price">Part E: Calculate mean annual price</a></li>
  </ul></li>
  <li><a href="#exercise-2-tidying-tuna-catch-data-again" id="toc-exercise-2-tidying-tuna-catch-data-again" class="nav-link" data-scroll-target="#exercise-2-tidying-tuna-catch-data-again">Exercise 2: Tidying tuna catch data (again)</a>
  <ul class="collapse">
  <li><a href="#part-a-read-the-tuna-catch-data" id="toc-part-a-read-the-tuna-catch-data" class="nav-link" data-scroll-target="#part-a-read-the-tuna-catch-data">Part A: Read the tuna catch data</a></li>
  </ul></li>
  <li><a href="#exercise-3-combine-your-catch-and-price-data" id="toc-exercise-3-combine-your-catch-and-price-data" class="nav-link" data-scroll-target="#exercise-3-combine-your-catch-and-price-data">Exercise 3: Combine your catch and price data</a>
  <ul class="collapse">
  <li><a href="#part-a-plan-the-join" id="toc-part-a-plan-the-join" class="nav-link" data-scroll-target="#part-a-plan-the-join">Part A: Plan the join</a></li>
  <li><a href="#part-b-perform-the-join" id="toc-part-b-perform-the-join" class="nav-link" data-scroll-target="#part-b-perform-the-join">Part B: Perform the join</a></li>
  <li><a href="#part-c-answer-the-questions-again" id="toc-part-c-answer-the-questions-again" class="nav-link" data-scroll-target="#part-c-answer-the-questions-again">Part C: Answer the questions again</a></li>
  </ul></li>
  <li><a href="#extra-exercises-for-you-to-practice" id="toc-extra-exercises-for-you-to-practice" class="nav-link" data-scroll-target="#extra-exercises-for-you-to-practice">Extra exercises for you to practice</a>
  <ul class="collapse">
  <li><a href="#exercise-1-pivot-longer-practice" id="toc-exercise-1-pivot-longer-practice" class="nav-link" data-scroll-target="#exercise-1-pivot-longer-practice">Exercise 1: Pivot Longer Practice</a></li>
  <li><a href="#exercise-2-pivot-wider-practice" id="toc-exercise-2-pivot-wider-practice" class="nav-link" data-scroll-target="#exercise-2-pivot-wider-practice">Exercise 2: Pivot Wider Practice</a></li>
  <li><a href="#exercise-3-joining-data-practice" id="toc-exercise-3-joining-data-practice" class="nav-link" data-scroll-target="#exercise-3-joining-data-practice">Exercise 3: Joining Data Practice</a></li>
  <li><a href="#exercise-4-sharks" id="toc-exercise-4-sharks" class="nav-link" data-scroll-target="#exercise-4-sharks">Exercise 4: Sharks!</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="07_live.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Tidying and Merging</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Juan Carlos Villaseñor-Derbez (JC) </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Last week you were asked:</p>
<blockquote class="blockquote">
<p>How much money have tuna purse seiners made since 2000 when fishing for bigeye tuna (<em>Thunnus obesus</em>) in the Eastern Pacific Ocean?</p>
</blockquote>
<p>We made some simplifying assumptions and got some values (a total of 3,070 M USD since 2000, or about 127 M USD per year). You are now tasked with coming up with more refined estimates. For example, we will account for the fact that the price of fish varies every year.</p>
<p>How we will approach this:</p>
<ul>
<li>Find data that shows prices per year and species</li>
<li>Read them, clean them, tidy them up (The “data tidying” part)</li>
<li>Combine our catch data from last week with this new price data (The “merging” part)</li>
<li>Re-calculate our total revenues since 2000</li>
</ul>
<p>This will require three pipelines:</p>
<ul>
<li>Tidy price data (Exercise 1)</li>
<li>Wrangle catch data (Exercise 2)</li>
<li>Combine tidy prices and catch data (Exercise 3)</li>
</ul>
<p>Pipelines 1 and 3 contain tools covered this week. You should already be familiar with pipeline 2.</p>
<section id="exercise-1-tidying-price-data" class="level1">
<h1>Exercise 1: Tidying price data</h1>
<section id="part-a-downloading-the-data" class="level2">
<h2 class="anchored" data-anchor-id="part-a-downloading-the-data">Part A: Downloading the data</h2>
<p><strong>Post-it up</strong></p>
<ol type="1">
<li>In a web browser, go to <a href="https://www.ffa.int/">ffa.int</a>. This is the website for the Pacific Islands Forum Fisheries Agency</li>
<li>Hover over “Publication and Statistics” on the top menu</li>
<li>Select “Statistics”</li>
<li>You will be taken to a site with five items. Download the zip folder called <code>Economic and Development Indicators and Statistics: Tuna Fishery of the Western and Central Pacific Ocean 2024</code></li>
<li>As before, place the downloaded zip file in your <code>EVR628/data/raw</code> folder and proceed to extract it</li>
<li>Open the excel file called <code>Compendium of Economic and Development Statistics 2024</code> and study the <code>Contents</code> tab</li>
<li>Can you identify the price data that we need?</li>
</ol>
<ul>
<li>Which sheet</li>
<li>What range?</li>
</ul>
<p><strong>Post-it down</strong></p>
</section>
<section id="part-b-reading-excel-data" class="level2">
<h2 class="anchored" data-anchor-id="part-b-reading-excel-data">Part B: Reading excel data</h2>
<p><strong>Post-it up</strong></p>
<ol type="1">
<li>Open your RStudio project for EVR628</li>
<li>In your console, install the <code>readxl</code> package: <code>install.packages("readxl")</code></li>
<li>Start a <strong>new</strong> script called <code>tuna_analysis_prices.R</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></li>
<li>Add the usual code commenting outline</li>
<li>We will need three packages: <code>readxl</code>, <code>janitor</code>, and <code>tidyverse</code>, load them at the top of your script using <code>library()</code></li>
<li>Use <code>?read_excel()</code> to look at the documentation for the function</li>
<li>Use <code>read_excel()</code> to create a new object called <code>tuna_prices</code> and read the price data we need<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Immediately pipe it into <code>clean_names</code>.</li>
</ol>
<p><strong>Post-it down</strong></p>
</section>
<section id="part-c-inspecting-price-data" class="level2">
<h2 class="anchored" data-anchor-id="part-c-inspecting-price-data">Part C: Inspecting price data</h2>
<p>Be prepared to discuss the following points:</p>
<p><strong>Post-it up</strong></p>
<ol type="1">
<li>Inspect the column names of <code>tuna_prices</code> using <code>colnames()</code> in your console.</li>
<li>How many columns and rows do we have?</li>
<li>Any missing values?</li>
<li>Do we need to make the data wider or longer?</li>
<li>Using comments, write out what the target data should be (expand my code chunk see what I wrote)</li>
</ol>
<p><strong>Post-it down</strong></p>
<p>See an example of my description below</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "year"          "japan_fresha"  "japan_frozenb" "us_freshc"    
[5] "us_frozend"   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28  5</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
   year japan_fresha japan_frozenb us_freshc us_frozend
  &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1  1997        8204.         8169.        NA         NA
2  1998        7703.         6320.        NA         NA
3  1999        8809.         9093.        NA         NA
4  2000        9198.         8557.        NA         NA</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The final data set should have two columns: year and price. Since we have four</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># prices (two markets, two presentations), I will use the average price per year.</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The tidy data set should therefore have four columns: year, market,</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># presentation, and price.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-d-tidy-your-price-data" class="level2">
<h2 class="anchored" data-anchor-id="part-d-tidy-your-price-data">Part D: Tidy your price data</h2>
<p><strong>Post-it up</strong></p>
<ol type="1">
<li>Look at the documentation for your <code>pivot_*</code> function. What does it say about cases where <code>names_to</code> is of length &gt; 1?</li>
<li>What about the <code>names_sep</code> argument?</li>
<li>Use the appropriate <code>pivot_*</code> function to reshape your data and save them to a new object called <code>tidy_tuna_prices</code><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></li>
<li>Your resulting tibble should have 104 rows and 4 columns and look like this:<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 104 × 4
    year market presentation price
   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt;
 1  1997 japan  fresha       8204.
 2  1997 japan  frozenb      8169.
 3  1998 japan  fresha       7703.
 4  1998 japan  frozenb      6320.
 5  1999 japan  fresha       8809.
 6  1999 japan  frozenb      9093.
 7  2000 japan  fresha       9198.
 8  2000 japan  frozenb      8557.
 9  2001 japan  fresha       8260.
10  2001 japan  frozenb      5983.
# ℹ 94 more rows</code></pre>
</div>
</div>
<p><strong>Post-it down</strong></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Values in <code>presentation</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the values in the <code>presentation</code> column are not ideal. They end in <code>a</code>, <code>b</code>, <code>c</code>, and <code>d</code> due to footnotes included in Excel. For now this doesn’t matter because we will quickly remove them. We’ll cover some text wrangling in Week 9.</p>
</div>
</div>
</section>
<section id="part-e-calculate-mean-annual-price" class="level2">
<h2 class="anchored" data-anchor-id="part-e-calculate-mean-annual-price">Part E: Calculate mean annual price</h2>
<p><strong>Post-it up</strong></p>
<ol type="1">
<li>Modify the pipeline that creates <code>tidy_tuna_prices</code> to get the mean price per year<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 28 × 2
    year price
   &lt;dbl&gt; &lt;dbl&gt;
 1  1997 8186.
 2  1998 7011.
 3  1999 8951.
 4  2000 8877.
 5  2001 5633.
 6  2002 5342.
 7  2003 5285.
 8  2004 5739.
 9  2005 5554.
10  2006 5177.
# ℹ 18 more rows</code></pre>
</div>
</div>
<p><strong>Post-it down</strong></p>
</section>
</section>
<section id="exercise-2-tidying-tuna-catch-data-again" class="level1">
<h1>Exercise 2: Tidying tuna catch data (again)</h1>
<section id="part-a-read-the-tuna-catch-data" class="level2">
<h2 class="anchored" data-anchor-id="part-a-read-the-tuna-catch-data">Part A: Read the tuna catch data</h2>
<blockquote class="blockquote">
<p>Note: You can copy-paste and modify your code from last week, but make sure your code is organized.</p>
</blockquote>
<p><strong>Post-it up</strong></p>
<ol type="1">
<li>Read in the tuna catch data from last week</li>
<li>Filter it to retain bigeye tuna (<code>BET</code>) caught by the purse seine fleet (<code>PS</code>) since 2000</li>
<li>Calculate <strong>total</strong> catch by year. Your final data should have 24 rows and 2 columns, as below</li>
</ol>
<p><strong>Post-it down</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 2
    year catch
   &lt;dbl&gt; &lt;dbl&gt;
 1  2000 95283
 2  2001 60518
 3  2002 57422
 4  2003 53051
 5  2004 65471
 6  2005 67895
 7  2006 83837
 8  2007 63451
 9  2008 75028
10  2009 76800
# ℹ 14 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-3-combine-your-catch-and-price-data" class="level1">
<h1>Exercise 3: Combine your catch and price data</h1>
<section id="part-a-plan-the-join" class="level2">
<h2 class="anchored" data-anchor-id="part-a-plan-the-join">Part A: Plan the join</h2>
<ol type="1">
<li>Think about what type of join you want</li>
<li>What will be on the left and what will be on the right?</li>
<li>What is the key?</li>
<li>Write down, using human language, what you want to do.</li>
</ol>
<p><strong>Post-it up</strong></p>
</section>
<section id="part-b-perform-the-join" class="level2">
<h2 class="anchored" data-anchor-id="part-b-perform-the-join">Part B: Perform the join</h2>
<ol type="1">
<li>Perform the join and save the output to an object called <code>tuna_revenues</code></li>
<li>Create a new column that contains the annual revenue in M USD. Pay attention to the units.</li>
</ol>
<p><strong>Post-it down</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 4
    year catch price revenue
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1  2000 95283 8877.    846.
 2  2001 60518 5633.    341.
 3  2002 57422 5342.    307.
 4  2003 53051 5285.    280.
 5  2004 65471 5739.    376.
 6  2005 67895 5554.    377.
 7  2006 83837 5177.    434.
 8  2007 63451 5054.    321.
 9  2008 75028 5636.    423.
10  2009 76800 6175.    474.
# ℹ 14 more rows</code></pre>
</div>
</div>
</section>
<section id="part-c-answer-the-questions-again" class="level2">
<h2 class="anchored" data-anchor-id="part-c-answer-the-questions-again">Part C: Answer the questions again</h2>
<ol type="1">
<li>How much TOTAL revenue since 2000?</li>
<li>How much mean ANNUAL revenue since 2000?</li>
<li>Make a figure</li>
<li>How do these plot and numbers compare to what we found <a href="https://jcvdav.github.io/EVR_628/docs/06_live.html#part-g-visualize-the-data-and-answer-the-question">last week</a>?</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11752.32</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 489.68</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="07_live_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="07_live_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="extra-exercises-for-you-to-practice" class="level1">
<h1>Extra exercises for you to practice</h1>
<p>The following four exercises use data that are built directly in R. You will need to copy and paste the provided code in your console (or R script) to make sure the objects appear in your environment.</p>
<section id="exercise-1-pivot-longer-practice" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-pivot-longer-practice">Exercise 1: Pivot Longer Practice</h2>
<p><strong>Scenario</strong>: You are a TA and have been given grade data where each row represents a student and columns represent their scores on assignments 1-4. You need to calculate the mean grade for each student.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>student_scores <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>student_id, <span class="sc">~</span>assignment_1, <span class="sc">~</span>assignment_2, <span class="sc">~</span>assignment_3, <span class="sc">~</span>assignment_4,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S001"</span>, <span class="dv">85</span>, <span class="dv">92</span>, <span class="dv">78</span>, <span class="dv">88</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S002"</span>, <span class="dv">91</span>, <span class="dv">89</span>, <span class="dv">95</span>, <span class="dv">82</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S003"</span>, <span class="dv">76</span>, <span class="dv">84</span>, <span class="dv">91</span>, <span class="dv">79</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S004"</span>, <span class="dv">88</span>, <span class="dv">93</span>, <span class="dv">87</span>, <span class="dv">94</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>student_scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  student_id assignment_1 assignment_2 assignment_3 assignment_4
  &lt;chr&gt;             &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
1 S001                 85           92           78           88
2 S002                 91           89           95           82
3 S003                 76           84           91           79
4 S004                 88           93           87           94</code></pre>
</div>
</div>
<p><strong>How I did it:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>student_scores_long <span class="ot">&lt;-</span> student_scores <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"assignment"</span>),  <span class="co"># All columns from assignment_1 to assignment_4</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"assignment"</span>,          <span class="co"># Create new column called "assignment" with column names</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"score"</span>)              <span class="co"># Create new column called "score" with the values</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>student_means <span class="ot">&lt;-</span> student_scores_long <span class="sc">|&gt;</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(student_id) <span class="sc">|&gt;</span>                        <span class="co"># Group rows by student_id</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_grade =</span> <span class="fu">mean</span>(score))           <span class="co"># Calculate mean score for each student</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>student_means                                   <span class="co"># View the result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  student_id mean_grade
  &lt;chr&gt;           &lt;dbl&gt;
1 S001             85.8
2 S002             89.2
3 S003             82.5
4 S004             90.5</code></pre>
</div>
</div>
</section>
<section id="exercise-2-pivot-wider-practice" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2-pivot-wider-practice">Exercise 2: Pivot Wider Practice</h2>
<p><strong>Scenario</strong>: You have hurricane exposure data from different Florida counties. You are asked to build a figure showing the relationship between pressure and wind speed. Modify the data as needed and build a figure.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the dataset</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>hurricane_data <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>county, <span class="sc">~</span>metric, <span class="sc">~</span>measurement,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Miami-Dade"</span>, <span class="st">"pressure"</span>, <span class="dv">950</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Miami-Dade"</span>, <span class="st">"precipitation"</span>, <span class="fl">12.5</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Miami-Dade"</span>, <span class="st">"wind_speed"</span>, <span class="dv">85</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Broward"</span>, <span class="st">"pressure"</span>, <span class="dv">955</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Broward"</span>, <span class="st">"precipitation"</span>, <span class="fl">8.3</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Broward"</span>, <span class="st">"wind_speed"</span>, <span class="dv">72</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Palm Beach"</span>, <span class="st">"pressure"</span>, <span class="dv">960</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Palm Beach"</span>, <span class="st">"precipitation"</span>, <span class="fl">6.1</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Palm Beach"</span>, <span class="st">"wind_speed"</span>, <span class="dv">68</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Monroe"</span>, <span class="st">"pressure"</span>, <span class="dv">945</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Monroe"</span>, <span class="st">"precipitation"</span>, <span class="fl">15.2</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Monroe"</span>, <span class="st">"wind_speed"</span>, <span class="dv">95</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>hurricane_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   county     metric        measurement
   &lt;chr&gt;      &lt;chr&gt;               &lt;dbl&gt;
 1 Miami-Dade pressure            950  
 2 Miami-Dade precipitation        12.5
 3 Miami-Dade wind_speed           85  
 4 Broward    pressure            955  
 5 Broward    precipitation         8.3
 6 Broward    wind_speed           72  
 7 Palm Beach pressure            960  
 8 Palm Beach precipitation         6.1
 9 Palm Beach wind_speed           68  
10 Monroe     pressure            945  
11 Monroe     precipitation        15.2
12 Monroe     wind_speed           95  </code></pre>
</div>
</div>
<p><strong>How I did it:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>hurricane_wide <span class="ot">&lt;-</span> hurricane_data <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> metric,     <span class="co"># Use values in "metric" column as new column names</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> measurement) <span class="co"># Use values in "measurement" column to fill new columns</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>hurricane_wide                        <span class="co"># Now each county is a row with separate columns for pressure, precipitation, wind_speed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  county     pressure precipitation wind_speed
  &lt;chr&gt;         &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;
1 Miami-Dade      950          12.5         85
2 Broward         955           8.3         72
3 Palm Beach      960           6.1         68
4 Monroe          945          15.2         95</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hurricane_wide,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pressure, <span class="at">y =</span> wind_speed)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Pressure"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wind speed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="07_live_files/figure-html/unnamed-chunk-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="07_live_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise-3-joining-data-practice" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3-joining-data-practice">Exercise 3: Joining Data Practice</h2>
<p><strong>Scenario</strong>: You have two datasets - one with student information and another with their enrollment details. You need to be able to identify the names of students taking stats courses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the datasets</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>students <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>student_id, <span class="sc">~</span>name, <span class="sc">~</span>age,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S001"</span>, <span class="st">"Alice Johnson"</span>, <span class="dv">20</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S002"</span>, <span class="st">"Bob Smith"</span>, <span class="dv">22</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S003"</span>, <span class="st">"Carol Davis"</span>, <span class="dv">19</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S004"</span>, <span class="st">"David Wilson"</span>, <span class="dv">21</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S005"</span>, <span class="st">"Eva Brown"</span>, <span class="dv">23</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>enrollments <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>stdt_identifier, <span class="sc">~</span>course, <span class="sc">~</span>credits,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S001"</span>, <span class="st">"Statistics"</span>, <span class="dv">3</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S001"</span>, <span class="st">"Biology"</span>, <span class="dv">4</span>,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S002"</span>, <span class="st">"Statistics"</span>, <span class="dv">3</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S003"</span>, <span class="st">"Chemistry"</span>, <span class="dv">4</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S004"</span>, <span class="st">"Statistics"</span>, <span class="dv">3</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S004"</span>, <span class="st">"Physics"</span>, <span class="dv">4</span>,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S006"</span>, <span class="st">"Math"</span>, <span class="dv">3</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>students</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  student_id name            age
  &lt;chr&gt;      &lt;chr&gt;         &lt;dbl&gt;
1 S001       Alice Johnson    20
2 S002       Bob Smith        22
3 S003       Carol Davis      19
4 S004       David Wilson     21
5 S005       Eva Brown        23</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>enrollments</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  stdt_identifier course     credits
  &lt;chr&gt;           &lt;chr&gt;        &lt;dbl&gt;
1 S001            Statistics       3
2 S001            Biology          4
3 S002            Statistics       3
4 S003            Chemistry        4
5 S004            Statistics       3
6 S004            Physics          4
7 S006            Math             3</code></pre>
</div>
</div>
<p><strong>How I did it:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> students <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(enrollments, <span class="at">by =</span> <span class="fu">join_by</span>(student_id <span class="sc">==</span> stdt_identifier)) <span class="co"># Keep all students, match different column names</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>combined_data                        <span class="co"># View the combined data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 5
  student_id name            age course     credits
  &lt;chr&gt;      &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;
1 S001       Alice Johnson    20 Statistics       3
2 S001       Alice Johnson    20 Biology          4
3 S002       Bob Smith        22 Statistics       3
4 S003       Carol Davis      19 Chemistry        4
5 S004       David Wilson     21 Statistics       3
6 S004       David Wilson     21 Physics          4
7 S005       Eva Brown        23 &lt;NA&gt;            NA</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>statistics_students <span class="ot">&lt;-</span> combined_data <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(course <span class="sc">==</span> <span class="st">"Statistics"</span>) <span class="sc">|&gt;</span> <span class="co"># Keep only rows where course equals "Statistics"</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, course)              <span class="co"># Keep only the name and course columns</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>statistics_students                 <span class="co"># View the result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name          course    
  &lt;chr&gt;         &lt;chr&gt;     
1 Alice Johnson Statistics
2 Bob Smith     Statistics
3 David Wilson  Statistics</code></pre>
</div>
</div>
</section>
<section id="exercise-4-sharks" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4-sharks">Exercise 4: Sharks!</h2>
<p><strong>Scenario</strong>: You have swimming data from beachgoers and bull shark detection data from acoustic telemetry during fourth of July. The swimming data tell you when someone entered and left the water. The shark detection data tells you which sharks were detected within the acoustic array in front of the beach, and the time of detection. Who was in the water while a shark was nearby?<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the datasets</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>swimming_data <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>name, <span class="sc">~</span>swim_start, <span class="sc">~</span>swim_end,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alice"</span>, <span class="st">"2024-07-04 10:30:00"</span>, <span class="st">"2024-07-04 11:15:00"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Bob"</span>, <span class="st">"2024-07-04 10:45:00"</span>, <span class="st">"2024-07-04 11:30:00"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Carol"</span>, <span class="st">"2024-07-04 11:00:00"</span>, <span class="st">"2024-07-04 11:45:00"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"David"</span>, <span class="st">"2024-07-04 11:20:00"</span>, <span class="st">"2024-07-04 12:00:00"</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Eva"</span>, <span class="st">"2024-07-04 12:10:00"</span>, <span class="st">"2024-07-04 12:45:00"</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">swim_start =</span> <span class="fu">as_datetime</span>(swim_start),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">swim_end =</span> <span class="fu">as_datetime</span>(swim_end))</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>shark_detections <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>shark_id, <span class="sc">~</span>detection_time,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SH001"</span>, <span class="st">"2024-07-04 09:40:00"</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SH002"</span>, <span class="st">"2024-07-04 11:25:00"</span>,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SH003"</span>, <span class="st">"2024-07-04 11:35:00"</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">detection_time =</span> <span class="fu">as_datetime</span>(detection_time))</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>swimming_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  name  swim_start          swim_end           
  &lt;chr&gt; &lt;dttm&gt;              &lt;dttm&gt;             
1 Alice 2024-07-04 10:30:00 2024-07-04 11:15:00
2 Bob   2024-07-04 10:45:00 2024-07-04 11:30:00
3 Carol 2024-07-04 11:00:00 2024-07-04 11:45:00
4 David 2024-07-04 11:20:00 2024-07-04 12:00:00
5 Eva   2024-07-04 12:10:00 2024-07-04 12:45:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>shark_detections</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  shark_id detection_time     
  &lt;chr&gt;    &lt;dttm&gt;             
1 SH001    2024-07-04 09:40:00
2 SH002    2024-07-04 11:25:00
3 SH003    2024-07-04 11:35:00</code></pre>
</div>
</div>
<p><strong>How I did it:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>swimmer_shark_overlap <span class="ot">&lt;-</span> shark_detections <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(swimming_data,            <span class="co"># Note that I am using an inner join. Play with inner, left, and right to see what happens</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">join_by</span>(<span class="fu">between</span>(detection_time, swim_start, swim_end))) <span class="co"># Find swimmers in water during shark detections</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>swimmer_shark_overlap               <span class="co"># View all the overlap data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  shark_id detection_time      name  swim_start          swim_end           
  &lt;chr&gt;    &lt;dttm&gt;              &lt;chr&gt; &lt;dttm&gt;              &lt;dttm&gt;             
1 SH002    2024-07-04 11:25:00 Bob   2024-07-04 10:45:00 2024-07-04 11:30:00
2 SH002    2024-07-04 11:25:00 Carol 2024-07-04 11:00:00 2024-07-04 11:45:00
3 SH002    2024-07-04 11:25:00 David 2024-07-04 11:20:00 2024-07-04 12:00:00
4 SH003    2024-07-04 11:35:00 Carol 2024-07-04 11:00:00 2024-07-04 11:45:00
5 SH003    2024-07-04 11:35:00 David 2024-07-04 11:20:00 2024-07-04 12:00:00</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>at_risk_swimmers <span class="ot">&lt;-</span> swimmer_shark_overlap <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span>  <span class="co"># Keep only the columns we want to see</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_sharks_near =</span> <span class="fu">n_distinct</span>(shark_id))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>at_risk_swimmers                   <span class="co"># These swimmers were in the water when sharks were detected</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name  n_sharks_near
  &lt;chr&gt;         &lt;int&gt;
1 Bob               1
2 Carol             2
3 David             2</code></pre>
</div>
</div>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>I would typically suggest to overwrite whatever we had last week in <code>tuna_analysis.R</code> because GitHub would keep a version, but I understand you might want to keep the script as is<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Hint: You will need to specify a file path, a sheet, and a range of cells.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Hint: Your <code>names_to</code> argument should be a character vector of with two items. <code>names_ _sep</code> should be inspired by our clever use of <code>snake_case</code>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Hint: If you have 112 rows, remember you can use <code>values_drop_na = T</code><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Hint: You will use <code>group_by()</code> and <code>summarize()</code>, as well as <code>|&gt;</code><a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Hint: Use <code>pivot_longer()</code> to transform this data so that each row represents one student-assignment-score combination, then use <code>group_by()</code> and <code>summarize()</code> to calculate the mean grade for each student.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Hint: Use <code>pivot_wider()</code> to transform this data so that each row represents a county and each metric becomes its own column.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Hint: Look at the documentation for <code>join_by()</code>. What does it say about “Overlap helpers”? You’ll want to use the <code>between()</code> function.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>